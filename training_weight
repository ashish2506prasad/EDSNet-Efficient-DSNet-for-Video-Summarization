{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "d98aaca1",
   "metadata": {
    "_cell_guid": "b1076dfc-b9ad-4769-8c92-a6c4dae69d19",
    "_uuid": "8f2839f25d086af736a60e9eeb907d3b93b6e0e5",
    "execution": {
     "iopub.execute_input": "2024-09-11T10:45:12.655581Z",
     "iopub.status.busy": "2024-09-11T10:45:12.654994Z",
     "iopub.status.idle": "2024-09-11T10:46:37.320559Z",
     "shell.execute_reply": "2024-09-11T10:46:37.319424Z"
    },
    "papermill": {
     "duration": 84.671667,
     "end_time": "2024-09-11T10:46:37.322978",
     "exception": false,
     "start_time": "2024-09-11T10:45:12.651311",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Collecting einops\r\n",
      "  Downloading einops-0.8.0-py3-none-any.whl.metadata (12 kB)\r\n",
      "Downloading einops-0.8.0-py3-none-any.whl (43 kB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m43.2/43.2 kB\u001b[0m \u001b[31m1.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hInstalling collected packages: einops\r\n",
      "Successfully installed einops-0.8.0\r\n",
      "Collecting ortools==9.10.4067\r\n",
      "  Downloading ortools-9.10.4067-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (2.9 kB)\r\n",
      "Collecting absl-py>=2.0.0 (from ortools==9.10.4067)\r\n",
      "  Downloading absl_py-2.1.0-py3-none-any.whl.metadata (2.3 kB)\r\n",
      "Requirement already satisfied: numpy>=1.13.3 in /opt/conda/lib/python3.10/site-packages (from ortools==9.10.4067) (1.26.4)\r\n",
      "Requirement already satisfied: pandas>=2.0.0 in /opt/conda/lib/python3.10/site-packages (from ortools==9.10.4067) (2.2.2)\r\n",
      "Collecting protobuf>=5.26.1 (from ortools==9.10.4067)\r\n",
      "  Downloading protobuf-5.28.0-cp38-abi3-manylinux2014_x86_64.whl.metadata (592 bytes)\r\n",
      "Requirement already satisfied: immutabledict>=3.0.0 in /opt/conda/lib/python3.10/site-packages (from ortools==9.10.4067) (4.2.0)\r\n",
      "Requirement already satisfied: python-dateutil>=2.8.2 in /opt/conda/lib/python3.10/site-packages (from pandas>=2.0.0->ortools==9.10.4067) (2.9.0.post0)\r\n",
      "Requirement already satisfied: pytz>=2020.1 in /opt/conda/lib/python3.10/site-packages (from pandas>=2.0.0->ortools==9.10.4067) (2024.1)\r\n",
      "Requirement already satisfied: tzdata>=2022.7 in /opt/conda/lib/python3.10/site-packages (from pandas>=2.0.0->ortools==9.10.4067) (2024.1)\r\n",
      "Requirement already satisfied: six>=1.5 in /opt/conda/lib/python3.10/site-packages (from python-dateutil>=2.8.2->pandas>=2.0.0->ortools==9.10.4067) (1.16.0)\r\n",
      "Downloading ortools-9.10.4067-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (26.7 MB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m26.7/26.7 MB\u001b[0m \u001b[31m64.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading absl_py-2.1.0-py3-none-any.whl (133 kB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m133.7/133.7 kB\u001b[0m \u001b[31m7.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading protobuf-5.28.0-cp38-abi3-manylinux2014_x86_64.whl (316 kB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m316.6/316.6 kB\u001b[0m \u001b[31m18.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hInstalling collected packages: protobuf, absl-py, ortools\r\n",
      "  Attempting uninstall: protobuf\r\n",
      "    Found existing installation: protobuf 3.20.3\r\n",
      "    Uninstalling protobuf-3.20.3:\r\n",
      "      Successfully uninstalled protobuf-3.20.3\r\n",
      "  Attempting uninstall: absl-py\r\n",
      "    Found existing installation: absl-py 1.4.0\r\n",
      "    Uninstalling absl-py-1.4.0:\r\n",
      "      Successfully uninstalled absl-py-1.4.0\r\n",
      "  Attempting uninstall: ortools\r\n",
      "    Found existing installation: ortools 9.4.1874\r\n",
      "    Uninstalling ortools-9.4.1874:\r\n",
      "      Successfully uninstalled ortools-9.4.1874\r\n",
      "\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\r\n",
      "apache-beam 2.46.0 requires cloudpickle~=2.2.1, but you have cloudpickle 3.0.0 which is incompatible.\r\n",
      "apache-beam 2.46.0 requires dill<0.3.2,>=0.3.1.1, but you have dill 0.3.8 which is incompatible.\r\n",
      "apache-beam 2.46.0 requires numpy<1.25.0,>=1.14.3, but you have numpy 1.26.4 which is incompatible.\r\n",
      "apache-beam 2.46.0 requires protobuf<4,>3.12.2, but you have protobuf 5.28.0 which is incompatible.\r\n",
      "apache-beam 2.46.0 requires pyarrow<10.0.0,>=3.0.0, but you have pyarrow 16.1.0 which is incompatible.\r\n",
      "google-ai-generativelanguage 0.6.6 requires protobuf!=3.20.0,!=3.20.1,!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.19.5, but you have protobuf 5.28.0 which is incompatible.\r\n",
      "google-api-core 2.11.1 requires protobuf!=3.20.0,!=3.20.1,!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0.dev0,>=3.19.5, but you have protobuf 5.28.0 which is incompatible.\r\n",
      "google-cloud-aiplatform 0.6.0a1 requires google-api-core[grpc]<2.0.0dev,>=1.22.2, but you have google-api-core 2.11.1 which is incompatible.\r\n",
      "google-cloud-artifact-registry 1.11.3 requires protobuf!=3.20.0,!=3.20.1,!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.19.5, but you have protobuf 5.28.0 which is incompatible.\r\n",
      "google-cloud-automl 1.0.1 requires google-api-core[grpc]<2.0.0dev,>=1.14.0, but you have google-api-core 2.11.1 which is incompatible.\r\n",
      "google-cloud-bigquery 2.34.4 requires protobuf<4.0.0dev,>=3.12.0, but you have protobuf 5.28.0 which is incompatible.\r\n",
      "google-cloud-bigquery-connection 1.15.3 requires protobuf!=3.20.0,!=3.20.1,!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.19.5, but you have protobuf 5.28.0 which is incompatible.\r\n",
      "google-cloud-bigtable 1.7.3 requires protobuf<4.0.0dev, but you have protobuf 5.28.0 which is incompatible.\r\n",
      "google-cloud-dlp 3.18.0 requires protobuf!=3.20.0,!=3.20.1,!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.19.5, but you have protobuf 5.28.0 which is incompatible.\r\n",
      "google-cloud-functions 1.16.3 requires protobuf!=3.20.0,!=3.20.1,!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.19.5, but you have protobuf 5.28.0 which is incompatible.\r\n",
      "google-cloud-iam 2.15.0 requires protobuf!=3.20.0,!=3.20.1,!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.19.5, but you have protobuf 5.28.0 which is incompatible.\r\n",
      "google-cloud-monitoring 2.21.0 requires protobuf!=3.20.0,!=3.20.1,!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.19.5, but you have protobuf 5.28.0 which is incompatible.\r\n",
      "google-cloud-pubsub 2.21.3 requires protobuf!=3.20.0,!=3.20.1,!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.19.5, but you have protobuf 5.28.0 which is incompatible.\r\n",
      "google-cloud-recommendations-ai 0.7.1 requires protobuf<5.0.0dev,>=3.19.0, but you have protobuf 5.28.0 which is incompatible.\r\n",
      "google-cloud-resource-manager 1.12.3 requires protobuf!=3.20.0,!=3.20.1,!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.19.5, but you have protobuf 5.28.0 which is incompatible.\r\n",
      "google-cloud-spanner 3.47.0 requires protobuf!=3.20.0,!=3.20.1,!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.2, but you have protobuf 5.28.0 which is incompatible.\r\n",
      "google-cloud-translate 3.12.1 requires protobuf!=3.20.0,!=3.20.1,!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.19.5, but you have protobuf 5.28.0 which is incompatible.\r\n",
      "google-cloud-vision 2.8.0 requires protobuf<4.0.0dev,>=3.19.0, but you have protobuf 5.28.0 which is incompatible.\r\n",
      "grpc-google-iam-v1 0.12.7 requires protobuf!=3.20.0,!=3.20.1,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.19.5, but you have protobuf 5.28.0 which is incompatible.\r\n",
      "kfp 2.5.0 requires google-cloud-storage<3,>=2.2.1, but you have google-cloud-storage 1.44.0 which is incompatible.\r\n",
      "kfp 2.5.0 requires protobuf<4,>=3.13.0, but you have protobuf 5.28.0 which is incompatible.\r\n",
      "kfp-pipeline-spec 0.2.2 requires protobuf<4,>=3.13.0, but you have protobuf 5.28.0 which is incompatible.\r\n",
      "opentelemetry-proto 1.25.0 requires protobuf<5.0,>=3.19, but you have protobuf 5.28.0 which is incompatible.\r\n",
      "proto-plus 1.23.0 requires protobuf<5.0.0dev,>=3.19.0, but you have protobuf 5.28.0 which is incompatible.\r\n",
      "tensorboard-plugin-profile 2.15.1 requires protobuf<5.0.0dev,>=3.19.6, but you have protobuf 5.28.0 which is incompatible.\r\n",
      "tensorflow 2.16.1 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.3, but you have protobuf 5.28.0 which is incompatible.\r\n",
      "tensorflow-metadata 0.14.0 requires protobuf<4,>=3.7, but you have protobuf 5.28.0 which is incompatible.\r\n",
      "tensorflow-serving-api 2.16.1 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.3, but you have protobuf 5.28.0 which is incompatible.\r\n",
      "tensorflow-transform 0.14.0 requires absl-py<2,>=0.7, but you have absl-py 2.1.0 which is incompatible.\r\n",
      "tensorflow-transform 0.14.0 requires protobuf<4,>=3.7, but you have protobuf 5.28.0 which is incompatible.\u001b[0m\u001b[31m\r\n",
      "\u001b[0mSuccessfully installed absl-py-2.1.0 ortools-9.10.4067 protobuf-4.25.3\r\n",
      "Requirement already satisfied: PyWavelets in /opt/conda/lib/python3.10/site-packages (1.6.0)\r\n",
      "Requirement already satisfied: numpy<3,>=1.22.4 in /opt/conda/lib/python3.10/site-packages (from PyWavelets) (1.26.4)\r\n",
      "Requirement already satisfied: setuptools in /opt/conda/lib/python3.10/site-packages (70.0.0)\r\n",
      "Collecting performer-pytorch\r\n",
      "  Downloading performer_pytorch-1.1.4-py3-none-any.whl.metadata (763 bytes)\r\n",
      "Requirement already satisfied: einops>=0.3 in /opt/conda/lib/python3.10/site-packages (from performer-pytorch) (0.8.0)\r\n",
      "Collecting local-attention>=1.1.1 (from performer-pytorch)\r\n",
      "  Downloading local_attention-1.9.15-py3-none-any.whl.metadata (683 bytes)\r\n",
      "Requirement already satisfied: torch>=1.6 in /opt/conda/lib/python3.10/site-packages (from performer-pytorch) (2.4.0)\r\n",
      "Collecting axial-positional-embedding>=0.1.0 (from performer-pytorch)\r\n",
      "  Downloading axial_positional_embedding-0.2.1.tar.gz (2.6 kB)\r\n",
      "  Preparing metadata (setup.py) ... \u001b[?25l-\b \bdone\r\n",
      "\u001b[?25hRequirement already satisfied: filelock in /opt/conda/lib/python3.10/site-packages (from torch>=1.6->performer-pytorch) (3.15.1)\r\n",
      "Requirement already satisfied: typing-extensions>=4.8.0 in /opt/conda/lib/python3.10/site-packages (from torch>=1.6->performer-pytorch) (4.12.2)\r\n",
      "Requirement already satisfied: sympy in /opt/conda/lib/python3.10/site-packages (from torch>=1.6->performer-pytorch) (1.13.2)\r\n",
      "Requirement already satisfied: networkx in /opt/conda/lib/python3.10/site-packages (from torch>=1.6->performer-pytorch) (3.3)\r\n",
      "Requirement already satisfied: jinja2 in /opt/conda/lib/python3.10/site-packages (from torch>=1.6->performer-pytorch) (3.1.4)\r\n",
      "Requirement already satisfied: fsspec in /opt/conda/lib/python3.10/site-packages (from torch>=1.6->performer-pytorch) (2024.6.1)\r\n",
      "Requirement already satisfied: MarkupSafe>=2.0 in /opt/conda/lib/python3.10/site-packages (from jinja2->torch>=1.6->performer-pytorch) (2.1.5)\r\n",
      "Requirement already satisfied: mpmath<1.4,>=1.1.0 in /opt/conda/lib/python3.10/site-packages (from sympy->torch>=1.6->performer-pytorch) (1.3.0)\r\n",
      "Downloading performer_pytorch-1.1.4-py3-none-any.whl (13 kB)\r\n",
      "Downloading local_attention-1.9.15-py3-none-any.whl (9.0 kB)\r\n",
      "Building wheels for collected packages: axial-positional-embedding\r\n",
      "  Building wheel for axial-positional-embedding (setup.py) ... \u001b[?25l-\b \b\\\b \bdone\r\n",
      "\u001b[?25h  Created wheel for axial-positional-embedding: filename=axial_positional_embedding-0.2.1-py3-none-any.whl size=2889 sha256=fe042bbb18d98d68bcb695b5703f149f32767d7fb3e7df74a71b886692bea854\r\n",
      "  Stored in directory: /root/.cache/pip/wheels/b1/cb/39/7ce7ff2d2fd37cfe1fe7b3a3c43cf410632b2ad3b3f3986d73\r\n",
      "Successfully built axial-positional-embedding\r\n",
      "Installing collected packages: local-attention, axial-positional-embedding, performer-pytorch\r\n",
      "Successfully installed axial-positional-embedding-0.2.1 local-attention-1.9.15 performer-pytorch-1.1.4\r\n",
      "Requirement already satisfied: local-attention in /opt/conda/lib/python3.10/site-packages (1.9.15)\r\n",
      "Requirement already satisfied: einops>=0.8.0 in /opt/conda/lib/python3.10/site-packages (from local-attention) (0.8.0)\r\n",
      "Requirement already satisfied: torch in /opt/conda/lib/python3.10/site-packages (from local-attention) (2.4.0)\r\n",
      "Requirement already satisfied: filelock in /opt/conda/lib/python3.10/site-packages (from torch->local-attention) (3.15.1)\r\n",
      "Requirement already satisfied: typing-extensions>=4.8.0 in /opt/conda/lib/python3.10/site-packages (from torch->local-attention) (4.12.2)\r\n",
      "Requirement already satisfied: sympy in /opt/conda/lib/python3.10/site-packages (from torch->local-attention) (1.13.2)\r\n",
      "Requirement already satisfied: networkx in /opt/conda/lib/python3.10/site-packages (from torch->local-attention) (3.3)\r\n",
      "Requirement already satisfied: jinja2 in /opt/conda/lib/python3.10/site-packages (from torch->local-attention) (3.1.4)\r\n",
      "Requirement already satisfied: fsspec in /opt/conda/lib/python3.10/site-packages (from torch->local-attention) (2024.6.1)\r\n",
      "Requirement already satisfied: MarkupSafe>=2.0 in /opt/conda/lib/python3.10/site-packages (from jinja2->torch->local-attention) (2.1.5)\r\n",
      "Requirement already satisfied: mpmath<1.4,>=1.1.0 in /opt/conda/lib/python3.10/site-packages (from sympy->torch->local-attention) (1.3.0)\r\n"
     ]
    }
   ],
   "source": [
    "!pip install einops\n",
    "!pip install ortools==9.10.4067\n",
    "!pip install PyWavelets\n",
    "!pip install setuptools\n",
    "!pip install performer-pytorch\n",
    "!pip install local-attention"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "a760e04b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-11T10:46:37.337484Z",
     "iopub.status.busy": "2024-09-11T10:46:37.336737Z",
     "iopub.status.idle": "2024-09-11T10:46:39.309297Z",
     "shell.execute_reply": "2024-09-11T10:46:39.308158Z"
    },
    "papermill": {
     "duration": 1.983062,
     "end_time": "2024-09-11T10:46:39.312395",
     "exception": false,
     "start_time": "2024-09-11T10:46:37.329333",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Cloning into 'DSNet_Kaggle'...\r\n",
      "remote: Enumerating objects: 679, done.\u001b[K\r\n",
      "remote: Counting objects: 100% (187/187), done.\u001b[K\r\n",
      "remote: Compressing objects: 100% (120/120), done.\u001b[K\r\n",
      "remote: Total 679 (delta 131), reused 117 (delta 66), pack-reused 492 (from 1)\u001b[K\r\n",
      "Receiving objects: 100% (679/679), 15.62 MiB | 48.33 MiB/s, done.\r\n",
      "Resolving deltas: 100% (469/469), done.\r\n"
     ]
    }
   ],
   "source": [
    "!git clone https://github.com/ashish2506prasad/DSNet_Kaggle"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "58ad0f0a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-11T10:46:39.328659Z",
     "iopub.status.busy": "2024-09-11T10:46:39.327896Z",
     "iopub.status.idle": "2024-09-11T11:56:58.961086Z",
     "shell.execute_reply": "2024-09-11T11:56:58.959925Z"
    },
    "papermill": {
     "duration": 4219.643958,
     "end_time": "2024-09-11T11:56:58.963800",
     "exception": false,
     "start_time": "2024-09-11T10:46:39.319842",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch: 0/300 Loss: 0.7717/0.2417/1.0134 F-score cur/max: 0.4477/0.4477\r\n",
      "Epoch: 30/300 Loss: 0.7210/0.1674/0.8885 F-score cur/max: 0.4145/0.5010\r\n",
      "Epoch: 60/300 Loss: 0.7644/0.2035/0.9679 F-score cur/max: 0.4239/0.5010\r\n",
      "Epoch: 90/300 Loss: 0.7399/0.2000/0.9398 F-score cur/max: 0.4244/0.5010\r\n",
      "Epoch: 120/300 Loss: 0.7132/0.1519/0.8650 F-score cur/max: 0.4358/0.5010\r\n",
      "Epoch: 150/300 Loss: 0.7587/0.1549/0.9136 F-score cur/max: 0.4050/0.5010\r\n",
      "Epoch: 180/300 Loss: 0.7032/0.1547/0.8579 F-score cur/max: 0.4406/0.5010\r\n",
      "Epoch: 210/300 Loss: 0.7080/0.1350/0.8430 F-score cur/max: 0.4427/0.5010\r\n",
      "Epoch: 240/300 Loss: 0.6937/0.1215/0.8153 F-score cur/max: 0.4497/0.5010\r\n",
      "Epoch: 270/300 Loss: 0.7534/0.1334/0.8868 F-score cur/max: 0.4276/0.5010\r\n",
      "avg time taken: 0.39892571449279784 max time taken: 1.8410100936889648 min time taken: 0.3677866458892822\r\n",
      "Epoch: 0/300 Loss: 0.7531/0.1919/0.9450 F-score cur/max: 0.3489/0.3489\r\n",
      "Epoch: 30/300 Loss: 0.7286/0.1936/0.9223 F-score cur/max: 0.3768/0.4553\r\n",
      "Epoch: 60/300 Loss: 0.7293/0.1597/0.8890 F-score cur/max: 0.4376/0.4777\r\n",
      "Epoch: 90/300 Loss: 0.7475/0.1599/0.9074 F-score cur/max: 0.4184/0.4842\r\n",
      "Epoch: 120/300 Loss: 0.7290/0.1583/0.8873 F-score cur/max: 0.4008/0.4842\r\n",
      "Epoch: 150/300 Loss: 0.7436/0.1586/0.9023 F-score cur/max: 0.4132/0.4842\r\n",
      "Epoch: 180/300 Loss: 0.7498/0.1633/0.9131 F-score cur/max: 0.4347/0.4842\r\n",
      "Epoch: 210/300 Loss: 0.7156/0.1561/0.8717 F-score cur/max: 0.4014/0.4842\r\n",
      "Epoch: 240/300 Loss: 0.7339/0.1456/0.8795 F-score cur/max: 0.4323/0.4842\r\n",
      "Epoch: 270/300 Loss: 0.7050/0.1341/0.8392 F-score cur/max: 0.4343/0.4842\r\n",
      "avg time taken: 0.3975234905878703 max time taken: 0.8484127521514893 min time taken: 0.37094569206237793\r\n",
      "Epoch: 0/300 Loss: 0.7136/0.2289/0.9425 F-score cur/max: 0.4626/0.4626\r\n",
      "Epoch: 30/300 Loss: 0.7252/0.2034/0.9286 F-score cur/max: 0.3781/0.5425\r\n",
      "Epoch: 60/300 Loss: 0.7347/0.1779/0.9125 F-score cur/max: 0.4156/0.5425\r\n",
      "Epoch: 90/300 Loss: 0.7534/0.1851/0.9385 F-score cur/max: 0.4063/0.5459\r\n",
      "Epoch: 120/300 Loss: 0.7091/0.1974/0.9065 F-score cur/max: 0.3331/0.5459\r\n",
      "Epoch: 150/300 Loss: 0.7129/0.1748/0.8877 F-score cur/max: 0.3498/0.5459\r\n",
      "Epoch: 180/300 Loss: 0.7345/0.1589/0.8934 F-score cur/max: 0.5016/0.5459\r\n",
      "Epoch: 210/300 Loss: 0.7165/0.1289/0.8454 F-score cur/max: 0.4221/0.5459\r\n",
      "Epoch: 240/300 Loss: 0.7167/0.1282/0.8449 F-score cur/max: 0.3739/0.5459\r\n",
      "Epoch: 270/300 Loss: 0.7112/0.1341/0.8453 F-score cur/max: 0.3337/0.5459\r\n",
      "avg time taken: 0.4020110813776652 max time taken: 1.1965148448944092 min time taken: 0.3761599063873291\r\n",
      "Epoch: 0/300 Loss: 0.7132/0.1743/0.8876 F-score cur/max: 0.4905/0.4905\r\n",
      "Epoch: 30/300 Loss: 0.7416/0.1686/0.9102 F-score cur/max: 0.4746/0.5314\r\n",
      "Epoch: 60/300 Loss: 0.7369/0.1916/0.9285 F-score cur/max: 0.4429/0.5314\r\n",
      "Epoch: 90/300 Loss: 0.7193/0.1520/0.8713 F-score cur/max: 0.4453/0.5314\r\n",
      "Epoch: 120/300 Loss: 0.7347/0.1633/0.8980 F-score cur/max: 0.4405/0.5314\r\n",
      "Epoch: 150/300 Loss: 0.7480/0.1306/0.8785 F-score cur/max: 0.5224/0.5314\r\n",
      "Epoch: 180/300 Loss: 0.7458/0.1264/0.8722 F-score cur/max: 0.4664/0.5314\r\n",
      "Epoch: 210/300 Loss: 0.7257/0.1282/0.8538 F-score cur/max: 0.4797/0.5314\r\n",
      "Epoch: 240/300 Loss: 0.7289/0.1128/0.8417 F-score cur/max: 0.5975/0.5975\r\n",
      "Epoch: 270/300 Loss: 0.7281/0.0966/0.8247 F-score cur/max: 0.4693/0.5975\r\n",
      "avg time taken: 0.40166101773579915 max time taken: 0.87355637550354 min time taken: 0.37562060356140137\r\n",
      "Epoch: 0/300 Loss: 0.7125/0.2076/0.9201 F-score cur/max: 0.3466/0.3466\r\n",
      "Epoch: 30/300 Loss: 0.7625/0.1691/0.9316 F-score cur/max: 0.3907/0.4250\r\n",
      "Epoch: 60/300 Loss: 0.7232/0.1798/0.9030 F-score cur/max: 0.4933/0.5012\r\n",
      "Epoch: 90/300 Loss: 0.7551/0.1715/0.9266 F-score cur/max: 0.3571/0.5879\r\n",
      "Epoch: 120/300 Loss: 0.7254/0.1754/0.9008 F-score cur/max: 0.3535/0.5879\r\n",
      "Epoch: 150/300 Loss: 0.6954/0.1378/0.8331 F-score cur/max: 0.3475/0.5879\r\n",
      "Epoch: 180/300 Loss: 0.7537/0.1360/0.8897 F-score cur/max: 0.3026/0.5879\r\n",
      "Epoch: 210/300 Loss: 0.7224/0.1133/0.8357 F-score cur/max: 0.3533/0.5879\r\n",
      "Epoch: 240/300 Loss: 0.7218/0.1342/0.8560 F-score cur/max: 0.3472/0.5879\r\n",
      "Epoch: 270/300 Loss: 0.7102/0.1262/0.8364 F-score cur/max: 0.3201/0.5879\r\n",
      "avg time taken: 0.3825790007909139 max time taken: 0.7680127620697021 min time taken: 0.36371850967407227\r\n",
      "Training done on summe. F-score: 0.5491\r\n",
      "Epoch: 0/300 Loss: 0.7379/0.2365/0.9744 F-score cur/max: 0.5541/0.5541\r\n",
      "Epoch: 30/300 Loss: 0.7481/0.2041/0.9522 F-score cur/max: 0.5350/0.5954\r\n",
      "Epoch: 60/300 Loss: 0.7264/0.1678/0.8942 F-score cur/max: 0.5490/0.6012\r\n",
      "Epoch: 90/300 Loss: 0.7367/0.1447/0.8814 F-score cur/max: 0.5685/0.6060\r\n",
      "Epoch: 120/300 Loss: 0.7217/0.1148/0.8365 F-score cur/max: 0.5852/0.6060\r\n",
      "Epoch: 150/300 Loss: 0.7261/0.1179/0.8440 F-score cur/max: 0.5516/0.6099\r\n",
      "Epoch: 180/300 Loss: 0.7153/0.0830/0.7983 F-score cur/max: 0.5331/0.6099\r\n",
      "Epoch: 210/300 Loss: 0.7240/0.0754/0.7994 F-score cur/max: 0.5824/0.6103\r\n",
      "Epoch: 240/300 Loss: 0.7134/0.0717/0.7851 F-score cur/max: 0.5768/0.6109\r\n",
      "Epoch: 270/300 Loss: 0.7105/0.0565/0.7670 F-score cur/max: 0.5660/0.6109\r\n",
      "avg time taken: 0.9623297842343649 max time taken: 2.13875150680542 min time taken: 0.8965497016906738\r\n",
      "Epoch: 0/300 Loss: 0.7524/0.2170/0.9695 F-score cur/max: 0.5395/0.5395\r\n",
      "Epoch: 30/300 Loss: 0.7410/0.1880/0.9290 F-score cur/max: 0.5214/0.5550\r\n",
      "Epoch: 60/300 Loss: 0.7391/0.1668/0.9059 F-score cur/max: 0.5535/0.5573\r\n",
      "Epoch: 90/300 Loss: 0.7153/0.1331/0.8483 F-score cur/max: 0.5449/0.5573\r\n",
      "Epoch: 120/300 Loss: 0.7205/0.1127/0.8332 F-score cur/max: 0.5169/0.5591\r\n",
      "Epoch: 150/300 Loss: 0.7013/0.0979/0.7992 F-score cur/max: 0.5420/0.5697\r\n",
      "Epoch: 180/300 Loss: 0.7201/0.0838/0.8039 F-score cur/max: 0.5513/0.5697\r\n",
      "Epoch: 210/300 Loss: 0.7049/0.0721/0.7770 F-score cur/max: 0.5517/0.5749\r\n",
      "Epoch: 240/300 Loss: 0.7221/0.0576/0.7797 F-score cur/max: 0.5002/0.5749\r\n",
      "Epoch: 270/300 Loss: 0.6605/0.0537/0.7142 F-score cur/max: 0.5211/0.5749\r\n",
      "avg time taken: 1.0723881840705871 max time taken: 2.156252145767212 min time taken: 0.9253404140472412\r\n",
      "Epoch: 0/300 Loss: 0.7501/0.2504/1.0005 F-score cur/max: 0.6379/0.6379\r\n",
      "Epoch: 30/300 Loss: 0.7470/0.1976/0.9446 F-score cur/max: 0.6138/0.6379\r\n",
      "Epoch: 60/300 Loss: 0.7385/0.1617/0.9002 F-score cur/max: 0.6033/0.6379\r\n",
      "Epoch: 90/300 Loss: 0.7376/0.1313/0.8689 F-score cur/max: 0.6446/0.6558\r\n",
      "Epoch: 120/300 Loss: 0.7290/0.1147/0.8437 F-score cur/max: 0.6200/0.6558\r\n",
      "Epoch: 150/300 Loss: 0.7223/0.1028/0.8251 F-score cur/max: 0.6334/0.6558\r\n",
      "Epoch: 180/300 Loss: 0.7218/0.0865/0.8084 F-score cur/max: 0.6239/0.6558\r\n",
      "Epoch: 210/300 Loss: 0.7081/0.0780/0.7860 F-score cur/max: 0.6482/0.6558\r\n",
      "Epoch: 240/300 Loss: 0.7203/0.0660/0.7864 F-score cur/max: 0.6309/0.6558\r\n",
      "Epoch: 270/300 Loss: 0.7014/0.0564/0.7578 F-score cur/max: 0.6134/0.6593\r\n",
      "avg time taken: 1.0677392959594727 max time taken: 2.308335781097412 min time taken: 0.9950988292694092\r\n",
      "Epoch: 0/300 Loss: 0.7535/0.2322/0.9856 F-score cur/max: 0.5752/0.5752\r\n",
      "Epoch: 30/300 Loss: 0.7271/0.1951/0.9222 F-score cur/max: 0.6025/0.6102\r\n",
      "Epoch: 60/300 Loss: 0.7436/0.1619/0.9055 F-score cur/max: 0.5646/0.6226\r\n",
      "Epoch: 90/300 Loss: 0.7406/0.1299/0.8706 F-score cur/max: 0.4477/0.6226\r\n",
      "Epoch: 120/300 Loss: 0.7277/0.1244/0.8521 F-score cur/max: 0.5917/0.6226\r\n",
      "Epoch: 150/300 Loss: 0.7233/0.1014/0.8247 F-score cur/max: 0.5384/0.6226\r\n",
      "Epoch: 180/300 Loss: 0.6963/0.0900/0.7863 F-score cur/max: 0.5162/0.6226\r\n",
      "Epoch: 210/300 Loss: 0.5885/0.0711/0.6595 F-score cur/max: 0.5017/0.6226\r\n",
      "Epoch: 240/300 Loss: 0.4030/0.0612/0.4642 F-score cur/max: 0.4027/0.6226\r\n",
      "Epoch: 270/300 Loss: 0.3612/0.0484/0.4096 F-score cur/max: 0.3709/0.6226\r\n",
      "avg time taken: 1.0487173438072204 max time taken: 2.1497771739959717 min time taken: 0.9636240005493164\r\n",
      "Epoch: 0/300 Loss: 0.7552/0.2103/0.9655 F-score cur/max: 0.5709/0.5709\r\n",
      "Epoch: 30/300 Loss: 0.7324/0.1714/0.9038 F-score cur/max: 0.4814/0.6062\r\n",
      "Epoch: 60/300 Loss: 0.7307/0.1456/0.8763 F-score cur/max: 0.6109/0.6358\r\n",
      "Epoch: 90/300 Loss: 0.7478/0.1283/0.8761 F-score cur/max: 0.5399/0.6358\r\n",
      "Epoch: 120/300 Loss: 0.7308/0.1106/0.8415 F-score cur/max: 0.5502/0.6358\r\n",
      "Epoch: 150/300 Loss: 0.7259/0.0921/0.8179 F-score cur/max: 0.5875/0.6358\r\n",
      "Epoch: 180/300 Loss: 0.7120/0.0757/0.7877 F-score cur/max: 0.6042/0.6358\r\n",
      "Epoch: 210/300 Loss: 0.6898/0.0652/0.7550 F-score cur/max: 0.4417/0.6358\r\n",
      "Epoch: 240/300 Loss: 0.5809/0.0529/0.6338 F-score cur/max: 0.3725/0.6358\r\n",
      "Epoch: 270/300 Loss: 0.4114/0.0461/0.4575 F-score cur/max: 0.3810/0.6358\r\n",
      "avg time taken: 1.0867063625653586 max time taken: 2.334456205368042 min time taken: 1.003821611404419\r\n",
      "Training done on tvsum. F-score: 0.6207\r\n"
     ]
    }
   ],
   "source": [
    "# nystromformer, anchor 12\n",
    "!python DSNet_Kaggle/src/train.py anchor-based --model-dir DSNet_Kaggle/models/nystrom_roi_default_fc_7  --splits DSNet_Kaggle/splits/summe.yml DSNet_Kaggle/splits/tvsum.yml --base-model nystromformer --model-depth shallow --max-epoch 300 --fc-depth 7 --pooling-type roi --where kaggle  "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "36d559cd",
   "metadata": {
    "papermill": {
     "duration": 0.014903,
     "end_time": "2024-09-11T11:56:58.994111",
     "exception": false,
     "start_time": "2024-09-11T11:56:58.979208",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "gpu",
   "dataSources": [
    {
     "datasetId": 5558958,
     "sourceId": 9195332,
     "sourceType": "datasetVersion"
    }
   ],
   "dockerImageVersionId": 30762,
   "isGpuEnabled": true,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.14"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 4309.326766,
   "end_time": "2024-09-11T11:56:59.328755",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2024-09-11T10:45:10.001989",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
